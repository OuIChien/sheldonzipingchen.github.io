---
layout: post
title: "配对交易模型简介"
date: 2016-02-03 11:15:29 +0800
description: 配对交易模型简介
categories: 量化交易
---
# 配对交易模型

配对交易是指八十年代中期华尔街著名投行 Morgan Stanley 的量化交易员 Nunzio Tartaglia 成立的一个数量分析团队提出的一种市场中性投资策略

Ganapathy Vidyamurthy在《Pairs Trading: Quantitative Methods and Analysis》一书中定义配对交易为两种类型：一类是基于统计套利的配对交易，一类是基于风险的配对交易。

基于统计套利的配对交易策略是一种市场中性策略，具体的说，是指从市场上找出历史股价走势相近的股票进行配对，当配对的股票价格差（Spreads）偏离历史均值时，则做空股价较高的股票同时买进股价较低的股票，等待他们回归到长期均衡关系，由此赚取两股票价格收敛的价格差。

# 配对交易的原理

配对交易策略的基本原理是基于两个相关性较高的股票或者其他证券，如果在未来时期保持着良好的相关性，一旦两者之间出现了背离的走势，且这种背离在未来是会得到纠正的，那么就可能产生套利的机会。对于配对交易的实践而言，如果两个相关性较高的股票或者其他证券之间出现背离，就应该买进表现相对较差的，卖出表现相对较好的。当未来两者之间的背离得到纠正，那么可以进行相反的平仓操作来获取利润。

由于配对交易利用配对间的短期错误定价，通过持有相对低估，卖空相对高估，因此其本质上是一个反转投资策略，其核心是学术文献中的股票价格均值回复。尽管配对交易策略非常简单，但却被广泛应用，其之所以能被广泛应用的主要原因是：首先，配对交易的收益与市场相对独立，即市场中性，也就是说，它与市场的上海或者下跌无关；其次，其收益的波动性相对较小；第三，其收益相对稳定。

# 配对交易特点

第一，配对交易利用了两个资产的短暂价格偏离的对称性，进行对冲以获取两个资产的 Alpha收益，其核心假设是配对资产的价差具有均值回复性。而这种均值回复是以交易者的非理性行为相关的。因为当市场中存在大量这类想法的交易者时，股票价格会产生上升的惯性，但这种上升惯性僅僅由于这一个非理性因素所驱动，并没有具体实际的基本面因素支撑，因而股价很快会跌落，就可以获得这两项资产价格偏离的收益了。在实际操作中，其执行过程可以简单地描述为：投资者首先选择相互匹配的两个资产，当配对资产价格差异增加的时候，做多价格偏低的资产，同时做空价格偏高的资产，而当价格差异减小的时候，则结束头寸，完成交易；同时，为了控制风险，当价差进一步扩大时，需要在适当的时候止损点结束头寸。

第二，配对交易是一种市场中性的交易策略。当观察到配对的资产价格差异增大到一定程度时，价格上升的资产建立空头，对价格下跌的资产建立多头。在一价定律的作用下，配对资产的价格差异将很快减小。这时，再买入价格下跌的资产对冲之前建立的空头头寸，同时卖出价格上涨的资产，获取两项资产的收益。就整个过程来看，配对交易在单一资产上都有系统风险和个别风险，但由于头寸始终是相反的。因此系统风险完全对冲，配对交易整体上只承担了配对资产的个别风险。而在一价定律下，价格对于价值的回复使得配对的资产的个别风险直接转换为个别收益。这种收益是于市场无关的。

# 配对交易的三种主要方法

## 协整法

Vidvamurthy(2004)通过利用资产之间的协整关系，尝试对配对交易使用参数化交易规则。Vidvamurthv 采用 Engle and Granger (1987) 的协整两步法，设资产A、B价格序列为 PAt，PBt ，则对数股票价格间的长期均衡关系可以表示为：

$ln(P^A_t)-\beta ln(P^B_t)=a+e_t$

式中，a 是常数项，$e_t$ 是零均值的平稳时间序列，标准化的协整向量为 $(1，\beta )$，协整误差 $e_t$ 视为错误定价，它反映了基于协整关系的股票组合偏离均衡关系的情况。

使用协整方法建立的股票多空组合，从长期来看组合中的股票之间具有均衡稳定关系。当股票价格变动使得该组合出现对长期关系的偏离，基于协整理论，可以预期这样的偏离或者波动是暂时的，在长期内会由于一支或两支股票的调整而回复到均衡关系。长期来看，股票市场中错误定价关系能够被修正，并不能给投资者带来收益。但是，这种偏差在中、短期股票市场中是存在的，并且反映出一定的趋势持续关系。长期来看，股票市场中错误定价关系能够被修正，并不能给投资者带来收益。但是，这种偏差在中、短期股票市场中是存在的，并且反映出一定的趋势持续和反转的特性。Vidvamurthy(2004)认为可以在市场中捕捉这样的偏差，设置合适的策略来获得收益。Vidvamurthv(2004)通过协整回归估计得到的残差序列：错误定价序列 $\{E_t\}$是平稳的，围绕其均值来回震荡，当超过某个临界值时可认为是异常行为，从而建立合适的头寸在回复到均值时来获取利润。

## 随机价差法

随机价差（Stochastic Spread）法是由Elliott et a1.,(2005)提出的，对资产价差序列利用状态空间模型进行建模。Elliottet a1.,(2005) 将资产 A， B 价格序列 $\{ p_t^A\}，\{p_t^B\}$ 的差$\{ y_t=p_t^A-p_t^B\}$的均值回复行为在连续时间情形下建模，采用状态空间方法，令价格差由一状态变量$x_t$来描述，$x_t$ 遵循 vasicek 过程：

$ {\rm d}x_t = k(\theta-x_t){\rm d}t+\sigma{\rm d}B_t $

上式中，${\rm d}B_t$为标准布朗运动。其中状态变量$x_t$，以速度K返回其均值$\sigma$，将可观测的价差表示为一均值回复的高斯噪声，即 $ y_t=x_t+w_t$

两个就构成了一个状态空间模型，该模型有以下三个主要优点：

首先，抓住了配对交易的核心，即均值回复性。严格地说价差应该表示为对数价格差即 $y_t=ln(p_t^A)-ln(p_t^B)。一般来说，两支股票的价格差的长期均值不是常数，而会随着两者价格上升变大，下降而变小；而采用对数价差可以避免出现上述问题。

其次，该模型是一个连续模型，因此可以用于预测。交易者可计算价差返回到其长期均值的时间，从而对配对交易关键的问题——如期望持有时间和期望收益，可以很容易计算。

最后，该模型易处理，参数可通过卡尔兹曼滤波方法估计。参数估计量是最大似然估计量且在最小均方误差下最优。对参数估计，采用欧拉离散化从而有状态方程：

$x_k=\theta (1-e^{-k \triangle})+e^{-k \triangle}x_{k-1}+e _{k}$

式中，$\triangle$表示两次观测之间的时间间隔（以年为单位），观测方程为：

$y_k = x_k + w_k$

有了上述的方程，可利用卡尔曼滤波递归方程可对参数 $\psi = \theta，k，\sigma$ 做出最优估计。

## 最小距离法

Gatev et a1.,(2006) 等运用最小距离法在标准化价格空间找到股票的相应配对，设置合适的交易规则并进行实际检验，发现配对交易可获取利润。最小距离法是一种非参数化方法，计算股票价格序列间的欧氏距离或者标准化的股票价格序列间的平方距离和来度量价差，进而衡量股票之间相对错误定价程度。选择合适的形成期，能过使标准化的股票价格序列间的平方距离最小化来选取相应的配对。配对选择后进入交易期，当两者之间标准化序列的差超过某个临界值则产生交易。
